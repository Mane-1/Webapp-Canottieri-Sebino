{% extends "layout/base.html" %}
{% block content %}
<h1>Atleti</h1>

<form method="get" class="row g-2 mb-3">
  <div class="col-auto">
    <input type="text" class="form-control" name="q" placeholder="Cerca" value="{{ q or '' }}">
  </div>
  <div class="col-auto">
    <select name="categoria" class="form-select">
      <option value="">Tutte le categorie</option>
      {% for c in categories %}
      <option value="{{ c.nome }}" {% if c.nome == categoria %}selected{% endif %}>{{ c.nome }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-auto">
    <button class="btn btn-primary" type="submit">Filtra</button>
  </div>
</form>

<p class="text-muted">Risultati: {{ total_rows }}. Pagina {{ page }} di {{ total_pages }}.</p>

<table class="table">
  <thead>
    <tr><th>Nome</th><th>Email</th><th>Categoria</th><th>Et√†</th></tr>
  </thead>
  <tbody>
  {% for row in rows %}
    <tr>
      <td><a href="/athletes/{{ row.user.id }}">{{ row.user.full_name }}</a></td>
      <td>{{ row.user.email or '' }}</td>
      <td>{{ row.category or '' }}</td>
      <td>{{ row.age or '' }}</td>
    </tr>
  {% endfor %}
  </tbody>
</table>

<nav>
  <ul class="pagination">
    <li class="page-item {% if page <= 1 %}disabled{% endif %}">
      <a class="page-link" href="?q={{ q }}&categoria={{ categoria }}&page={{ page-1 }}" tabindex="-1">Precedente</a>
    </li>
    <li class="page-item disabled"><span class="page-link">Pagina {{ page }} / {{ total_pages }}</span></li>
    <li class="page-item {% if page >= total_pages %}disabled{% endif %}">
      <a class="page-link" href="?q={{ q }}&categoria={{ categoria }}&page={{ page+1 }}">Successiva</a>
    </li>
  </ul>
</nav>
{% endblock %}
